2022-11-21 09:51:34,782 INFO:                                    <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> to archived folder. [in function archive_file                                    filename:file_handler.py:58]
2022-11-21 09:51:34,825 INFO:                                    <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file                                    filename:file_handler.py:73]
2022-11-21 09:58:35,462 INFO:                                    {file} checked, not a duplicate. [in function check_file                                    filename:file_handler.py:32]
2022-11-21 09:58:35,483 ERROR:                                    File name: file.jpg is not an excel file [in function check_file                                    filename:file_handler.py:23]
2022-11-21 09:58:35,501 ERROR:                                    File name: short.xlsx is too short. [in function check_file                                    filename:file_handler.py:26]
2022-11-21 09:58:35,527 ERROR:                                    duplicate.xlsx duplicate file | check_file [in function check_file                                    filename:file_handler.py:30]
2022-11-21 09:58:35,546 ERROR:                                    Data uanble to load: File is not a zip file | read_file [in function read_file                                    filename:file_handler.py:46]
Traceback (most recent call last):
  File "/vagrant/expediaproject/parser/file_handler.py", line 42, in read_file
    workbook = load_workbook(file, data_only=True)
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 315, in load_workbook
    reader = ExcelReader(filename, read_only, keep_vba,
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 124, in __init__
    self.archive = _validate_archive(fn)
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 96, in _validate_archive
    archive = ZipFile(filename, 'r')
  File "/usr/lib/python3.10/zipfile.py", line 1267, in __init__
    self._RealGetContents()
  File "/usr/lib/python3.10/zipfile.py", line 1334, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2022-11-21 09:58:36,070 INFO:                                    <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file                                    filename:file_handler.py:43]
2022-11-21 09:58:36,090 INFO:                                    <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> to archived folder. [in function archive_file                                    filename:file_handler.py:58]
2022-11-21 09:58:36,122 INFO:                                    <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file                                    filename:file_handler.py:73]
2022-11-21 09:59:56,148 INFO:                                    {file} checked, not a duplicate. [in function check_file                                    filename:file_handler.py:32]
2022-11-21 09:59:56,170 ERROR:                                    File name: file.jpg is not an excel file [in function check_file                                    filename:file_handler.py:23]
2022-11-21 09:59:56,195 ERROR:                                    File name: short.xlsx is too short. [in function check_file                                    filename:file_handler.py:26]
2022-11-21 09:59:56,222 ERROR:                                    duplicate.xlsx duplicate file | check_file [in function check_file                                    filename:file_handler.py:30]
2022-11-21 09:59:56,251 ERROR:                                    Data uanble to load: File is not a zip file | read_file [in function read_file                                    filename:file_handler.py:46]
Traceback (most recent call last):
  File "/vagrant/expediaproject/parser/file_handler.py", line 42, in read_file
    workbook = load_workbook(file, data_only=True)
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 315, in load_workbook
    reader = ExcelReader(filename, read_only, keep_vba,
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 124, in __init__
    self.archive = _validate_archive(fn)
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 96, in _validate_archive
    archive = ZipFile(filename, 'r')
  File "/usr/lib/python3.10/zipfile.py", line 1267, in __init__
    self._RealGetContents()
  File "/usr/lib/python3.10/zipfile.py", line 1334, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2022-11-21 09:59:56,755 INFO:                                    <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file                                    filename:file_handler.py:43]
2022-11-21 09:59:56,784 INFO:                                    <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> to archived folder. [in function archive_file                                    filename:file_handler.py:58]
2022-11-21 09:59:56,809 INFO:                                    <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file                                    filename:file_handler.py:73]
2022-11-21 10:03:29,255 INFO:                                    {file} checked, not a duplicate. [in function check_file                                    filename:file_handler.py:32]
2022-11-21 10:03:29,258 INFO:                                    Year successfully parsed form file name. [in function check_year                                    filename:name_parser.py:25]
2022-11-21 10:03:29,263 INFO:                                    Month successfully parsed from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month                                    filename:name_parser.py:43]
2022-11-21 10:03:29,265 INFO:                                    Date generated from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date                                    filename:name_parser.py:60]
2022-11-21 10:03:29,665 INFO:                                    <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file                                    filename:file_handler.py:43]
2022-11-21 10:03:29,671 INFO:                                    Year successfully parsed form file name. [in function check_year                                    filename:name_parser.py:25]
2022-11-21 10:03:29,673 INFO:                                    Month successfully parsed from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month                                    filename:name_parser.py:43]
2022-11-21 10:03:29,675 INFO:                                    Date generated from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date                                    filename:name_parser.py:60]
2022-11-21 10:03:29,678 INFO:                                    mar-18 found in <Worksheet "Summary Rolling MoM">. [in function find_row                                    filename:worksheet_search.py:25]
2022-11-21 10:03:29,680 INFO:                                    Calls Offered located in <Worksheet "Summary Rolling MoM">. [in function find_column                                    filename:worksheet_search.py:53]
2022-11-21 10:03:29,682 INFO:                                    Abandon after 30s located in <Worksheet "Summary Rolling MoM">. [in function find_column                                    filename:worksheet_search.py:53]
2022-11-21 10:03:29,685 INFO:                                    FCR located in <Worksheet "Summary Rolling MoM">. [in function find_column                                    filename:worksheet_search.py:53]
2022-11-21 10:03:29,687 INFO:                                    DSAT  located in <Worksheet "Summary Rolling MoM">. [in function find_column                                    filename:worksheet_search.py:53]
2022-11-21 10:03:29,690 INFO:                                    CSAT  located in <Worksheet "Summary Rolling MoM">. [in function find_column                                    filename:worksheet_search.py:53]
2022-11-21 10:03:29,691 CRITICAL:                                    74.40% [in function summary_data                                    filename:record_parser.py:51]
2022-11-21 10:03:29,694 INFO:                                    Summary data parsed for <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function summary_data                                    filename:record_parser.py:56]
2022-11-21 10:03:30,054 INFO:                                    <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file                                    filename:file_handler.py:43]
2022-11-21 10:03:30,058 INFO:                                    Year successfully parsed form file name. [in function check_year                                    filename:name_parser.py:25]
2022-11-21 10:03:30,060 INFO:                                    Month successfully parsed from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month                                    filename:name_parser.py:43]
2022-11-21 10:03:30,062 INFO:                                    Date generated from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date                                    filename:name_parser.py:60]
2022-11-21 10:03:30,065 INFO:                                    mar located in <Worksheet "VOC Rolling MoM">. [in function find_column                                    filename:worksheet_search.py:53]
2022-11-21 10:03:30,068 INFO:                                    Promoters found in <Worksheet "VOC Rolling MoM">. [in function find_row                                    filename:worksheet_search.py:30]
2022-11-21 10:03:30,073 ERROR:                                    Value for Promoters is missing or invalid | check_score [in function check_score                                    filename:record_parser.py:125]
2022-11-21 10:03:30,074 INFO:                                    Promoters, Passives, and Dectractors scores found. [in function check_score                                    filename:record_parser.py:127]
2022-11-21 10:03:30,077 INFO:                                    Passives found in <Worksheet "VOC Rolling MoM">. [in function find_row                                    filename:worksheet_search.py:30]
2022-11-21 10:03:30,079 ERROR:                                    Value for Passives is missing or invalid | check_score [in function check_score                                    filename:record_parser.py:125]
2022-11-21 10:03:30,081 INFO:                                    Promoters, Passives, and Dectractors scores found. [in function check_score                                    filename:record_parser.py:127]
2022-11-21 10:03:30,084 INFO:                                    Dectractors found in <Worksheet "VOC Rolling MoM">. [in function find_row                                    filename:worksheet_search.py:30]
2022-11-21 10:03:30,086 ERROR:                                    Value for Dectractors is missing or invalid | check_score [in function check_score                                    filename:record_parser.py:125]
2022-11-21 10:03:30,088 INFO:                                    Promoters, Passives, and Dectractors scores found. [in function check_score                                    filename:record_parser.py:127]
2022-11-21 10:03:30,090 INFO:                                    VOC data processed from expedia_report_monthly_march_2018.xlsx. [in function voc_data                                    filename:record_parser.py:104]
2022-11-21 10:03:30,092 INFO:                                    Calls Offered: 22343 |         Abandon after 30s: 3.05% | FCR: 86.00%         | DSAT: 18.00% | CSAT: 18.00% [in function index                                    filename:app.py:56]
2022-11-21 10:03:30,094 INFO:                                    Promoters: bad | Passives: bad | Dectractors: bad [in function index                                    filename:app.py:57]
2022-11-21 10:03:30,100 INFO:                                    <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> to archived folder. [in function archive_file                                    filename:file_handler.py:58]
2022-11-21 10:03:30,106 INFO:                                    expedia_report_monthly_march_2018.xlsx archived. [in function index                                    filename:app.py:63]
2022-11-21 10:03:30,157 INFO:                                    {file} checked, not a duplicate. [in function check_file                                    filename:file_handler.py:32]
2022-11-21 10:03:30,161 INFO:                                    <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file                                    filename:file_handler.py:73]
2022-11-21 10:03:30,168 ERROR:                                    Could not extract ['20'] | check_year [in function check_year                                    filename:name_parser.py:22]
2022-11-21 10:03:30,171 INFO:                                    Month successfully parsed from <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month                                    filename:name_parser.py:43]
2022-11-21 10:03:30,175 INFO:                                    Date generated from <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date                                    filename:name_parser.py:60]
2022-11-21 10:03:30,558 INFO:                                    <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file                                    filename:file_handler.py:43]
2022-11-21 10:03:30,564 INFO:                                    <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file                                    filename:file_handler.py:73]
2022-11-21 10:03:30,571 ERROR:                                    Could not extract ['20'] | check_year [in function check_year                                    filename:name_parser.py:22]
2022-11-21 10:03:30,574 INFO:                                    Month successfully parsed from <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month                                    filename:name_parser.py:43]
