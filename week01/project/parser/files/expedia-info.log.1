2022-11-21 21:08:09,533 INFO:     {file} checked, not a duplicate. [in function check_file     filename:file_handler.py:32]
2022-11-21 21:08:09,536 INFO:     Year successfully parsed form file name. [in function check_year     filename:name_parser.py:26]
2022-11-21 21:08:09,539 INFO:     Month successfully parsed from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month     filename:name_parser.py:44]
2022-11-21 21:08:09,542 INFO:     Date generated from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date     filename:name_parser.py:67]
2022-11-21 21:08:10,300 INFO:     <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file     filename:file_handler.py:44]
2022-11-21 21:08:10,305 INFO:     Year successfully parsed form file name. [in function check_year     filename:name_parser.py:26]
2022-11-21 21:08:10,328 INFO:     Month successfully parsed from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month     filename:name_parser.py:44]
2022-11-21 21:08:10,337 INFO:     Date generated from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date     filename:name_parser.py:67]
2022-11-21 21:08:10,342 INFO:     mar-18 found in <Worksheet "Summary Rolling MoM">. [in function find_row     filename:worksheet_search.py:25]
2022-11-21 21:08:10,345 INFO:     Calls Offered located in <Worksheet "Summary Rolling MoM">. [in function find_column     filename:worksheet_search.py:53]
2022-11-21 21:08:10,347 INFO:     Abandon after 30s located in <Worksheet "Summary Rolling MoM">. [in function find_column     filename:worksheet_search.py:53]
2022-11-21 21:08:10,349 INFO:     FCR located in <Worksheet "Summary Rolling MoM">. [in function find_column     filename:worksheet_search.py:53]
2022-11-21 21:08:10,351 INFO:     DSAT  located in <Worksheet "Summary Rolling MoM">. [in function find_column     filename:worksheet_search.py:53]
2022-11-21 21:08:10,353 INFO:     CSAT  located in <Worksheet "Summary Rolling MoM">. [in function find_column     filename:worksheet_search.py:53]
2022-11-21 21:08:10,355 CRITICAL:     74.40% [in function summary_data     filename:record_parser.py:52]
2022-11-21 21:08:10,359 INFO:     Summary data parsed for <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function summary_data     filename:record_parser.py:57]
2022-11-21 21:08:11,034 INFO:     <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file     filename:file_handler.py:44]
2022-11-21 21:08:11,039 INFO:     Year successfully parsed form file name. [in function check_year     filename:name_parser.py:26]
2022-11-21 21:08:11,042 INFO:     Month successfully parsed from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month     filename:name_parser.py:44]
2022-11-21 21:08:11,044 INFO:     Date generated from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date     filename:name_parser.py:67]
2022-11-21 21:08:11,047 INFO:     mar located in <Worksheet "VOC Rolling MoM">. [in function find_column     filename:worksheet_search.py:53]
2022-11-21 21:08:11,051 INFO:     Promoters found in <Worksheet "VOC Rolling MoM">. [in function find_row     filename:worksheet_search.py:30]
2022-11-21 21:08:11,053 ERROR:     Value for Promoters is missing or invalid | check_score [in function check_score     filename:record_parser.py:128]
2022-11-21 21:08:11,082 INFO:     Promoters, Passives, and Dectractors scores found. [in function check_score     filename:record_parser.py:130]
2022-11-21 21:08:11,085 INFO:     Passives found in <Worksheet "VOC Rolling MoM">. [in function find_row     filename:worksheet_search.py:30]
2022-11-21 21:08:11,087 ERROR:     Value for Passives is missing or invalid | check_score [in function check_score     filename:record_parser.py:128]
2022-11-21 21:08:11,089 INFO:     Promoters, Passives, and Dectractors scores found. [in function check_score     filename:record_parser.py:130]
2022-11-21 21:08:11,092 INFO:     Dectractors found in <Worksheet "VOC Rolling MoM">. [in function find_row     filename:worksheet_search.py:30]
2022-11-21 21:08:11,094 ERROR:     Value for Dectractors is missing or invalid | check_score [in function check_score     filename:record_parser.py:128]
2022-11-21 21:08:11,095 INFO:     Promoters, Passives, and Dectractors scores found. [in function check_score     filename:record_parser.py:130]
2022-11-21 21:08:11,097 INFO:     VOC data processed from expedia_report_monthly_march_2018.xlsx. [in function voc_data     filename:record_parser.py:106]
2022-11-21 21:08:11,099 INFO:     Calls Offered: 22343 |         Abandon after 30s: 3.05% | FCR: 86.00%         | DSAT: 18.00% | CSAT: 18.00% [in function index     filename:app.py:56]
2022-11-21 21:08:11,101 INFO:     Promoters: bad | Passives: bad | Dectractors: bad [in function index     filename:app.py:57]
2022-11-21 21:08:11,106 INFO:     <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> to archived folder. [in function archive_file     filename:file_handler.py:60]
2022-11-21 21:08:11,112 INFO:     File archived. [in function index     filename:app.py:63]
2022-11-21 21:08:11,204 INFO:     {file} checked, not a duplicate. [in function check_file     filename:file_handler.py:32]
2022-11-21 21:08:11,210 INFO:     <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file     filename:file_handler.py:75]
2022-11-21 21:08:11,217 ERROR:     Could not extract ['20'] | check_year [in function check_year     filename:name_parser.py:23]
2022-11-21 21:08:11,220 INFO:     Month successfully parsed from <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month     filename:name_parser.py:44]
2022-11-21 21:08:11,223 ERROR:     Could not parse date month: mar year:                 -1 from bad_file_date_march_20.xlsx [in function get_date     filename:name_parser.py:62]
2022-11-21 21:08:11,225 ERROR:     Rejected: could not parse date from bad_file_date_march_20.xlsx [in function index     filename:app.py:43]
2022-11-21 21:08:11,228 INFO:     <FileStorage: 'bad_file_date_march_20.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file     filename:file_handler.py:75]
2022-11-21 21:08:11,294 INFO:     {file} checked, not a duplicate. [in function check_file     filename:file_handler.py:32]
2022-11-21 21:08:11,334 INFO:     Year successfully parsed form file name. [in function check_year     filename:name_parser.py:26]
2022-11-21 21:08:11,337 INFO:     Month successfully parsed from <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month     filename:name_parser.py:44]
2022-11-21 21:08:11,339 INFO:     Date generated from <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date     filename:name_parser.py:67]
2022-11-21 21:08:12,094 INFO:     <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file     filename:file_handler.py:44]
2022-11-21 21:08:12,099 ERROR:     Could not locate Summary Rolling MoM in <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> | summary_data [in function summary_data     filename:record_parser.py:23]
2022-11-21 21:08:12,880 INFO:     <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file     filename:file_handler.py:44]
2022-11-21 21:08:12,886 INFO:     Year successfully parsed form file name. [in function check_year     filename:name_parser.py:26]
2022-11-21 21:08:12,889 INFO:     Month successfully parsed from <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month     filename:name_parser.py:44]
2022-11-21 21:08:12,891 INFO:     Date generated from <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date     filename:name_parser.py:67]
2022-11-21 21:08:12,894 INFO:     Jan located in <Worksheet "VOC Rolling MoM"> [in function find_column     filename:worksheet_search.py:59]
2022-11-21 21:08:12,897 INFO:     Promoters found in <Worksheet "VOC Rolling MoM">. [in function find_row     filename:worksheet_search.py:30]
2022-11-21 21:08:12,899 ERROR:     Value for Promoters is missing or invalid | check_score [in function check_score     filename:record_parser.py:128]
2022-11-21 21:08:12,901 INFO:     Promoters, Passives, and Dectractors scores found. [in function check_score     filename:record_parser.py:130]
2022-11-21 21:08:12,904 INFO:     Passives found in <Worksheet "VOC Rolling MoM">. [in function find_row     filename:worksheet_search.py:30]
2022-11-21 21:08:12,906 ERROR:     Value for Passives is missing or invalid | check_score [in function check_score     filename:record_parser.py:128]
2022-11-21 21:08:12,908 INFO:     Promoters, Passives, and Dectractors scores found. [in function check_score     filename:record_parser.py:130]
2022-11-21 21:08:12,935 INFO:     Dectractors found in <Worksheet "VOC Rolling MoM">. [in function find_row     filename:worksheet_search.py:30]
2022-11-21 21:08:12,937 ERROR:     Value for Dectractors is missing or invalid | check_score [in function check_score     filename:record_parser.py:128]
2022-11-21 21:08:12,942 INFO:     Promoters, Passives, and Dectractors scores found. [in function check_score     filename:record_parser.py:130]
2022-11-21 21:08:12,945 INFO:     VOC data processed from missing_ws_january_2018.xlsx. [in function voc_data     filename:record_parser.py:106]
2022-11-21 21:08:12,947 ERROR:     Not processed, invalid or missing worksheets/data. [in function index     filename:app.py:50]
2022-11-21 21:08:12,950 INFO:     <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file     filename:file_handler.py:75]
2022-11-21 21:08:13,006 ERROR:     File name: file.jpg is not an excel file [in function check_file     filename:file_handler.py:23]
2022-11-21 21:08:13,009 ERROR:     Upload failed: incorrect filetype [in function index     filename:app.py:36]
2022-11-21 21:08:13,013 INFO:     <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file     filename:file_handler.py:75]
2022-11-21 21:08:13,071 INFO:     {file} checked, not a duplicate. [in function check_file     filename:file_handler.py:32]
2022-11-21 21:08:13,081 ERROR:     File name: file.jpg is not an excel file [in function check_file     filename:file_handler.py:23]
2022-11-21 21:08:13,129 ERROR:     File name: short.xlsx is too short. [in function check_file     filename:file_handler.py:26]
2022-11-21 21:08:13,142 ERROR:     duplicate.xlsx duplicate file | check_file [in function check_file     filename:file_handler.py:30]
2022-11-21 21:08:13,154 ERROR:     Data uanble to load: File is not a zip file | read_file [in function read_file     filename:file_handler.py:47]
Traceback (most recent call last):
  File "/vagrant/expediaproject/parser/file_handler.py", line 43, in read_file
    workbook = load_workbook(file, data_only=True)
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 315, in load_workbook
    reader = ExcelReader(filename, read_only, keep_vba,
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 124, in __init__
    self.archive = _validate_archive(fn)
  File "/home/vagrant/parser/lib/python3.10/site-packages/openpyxl/reader/excel.py", line 96, in _validate_archive
    archive = ZipFile(filename, 'r')
  File "/usr/lib/python3.10/zipfile.py", line 1267, in __init__
    self._RealGetContents()
  File "/usr/lib/python3.10/zipfile.py", line 1334, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2022-11-21 21:08:14,095 INFO:     <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file     filename:file_handler.py:44]
2022-11-21 21:08:14,147 INFO:     <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> to archived folder. [in function archive_file     filename:file_handler.py:60]
2022-11-21 21:08:14,384 INFO:     <FileStorage: 'file.jpg' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> moved to error folder. [in function error_file     filename:file_handler.py:75]
2022-11-21 21:08:14,429 ERROR:     ERROR: unable to extract month from <FileStorage: 'argumentexception.xlxs' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>| check_month [in function check_month     filename:name_parser.py:46]
2022-11-21 21:08:15,318 INFO:     <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file     filename:file_handler.py:44]
2022-11-21 21:08:15,323 ERROR:     Could not locate Summary Rolling MoM in <FileStorage: 'missing_ws_january_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> | summary_data [in function summary_data     filename:record_parser.py:23]
2022-11-21 21:08:15,995 INFO:     <FileStorage: 'bad_summary_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> read. [in function read_file     filename:file_handler.py:44]
2022-11-21 21:08:16,000 INFO:     Year successfully parsed form file name. [in function check_year     filename:name_parser.py:26]
2022-11-21 21:08:16,036 INFO:     Month successfully parsed from <FileStorage: 'bad_summary_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month     filename:name_parser.py:44]
2022-11-21 21:08:16,038 INFO:     Date generated from <FileStorage: 'bad_summary_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')> [in function get_date     filename:name_parser.py:67]
2022-11-21 21:08:16,041 ERROR:     mar-18 not found in <Worksheet "Summary Rolling MoM"> | find_row [in function find_row     filename:worksheet_search.py:33]
2022-11-21 21:08:16,043 INFO:     Calls Offered located in <Worksheet "Summary Rolling MoM">. [in function find_column     filename:worksheet_search.py:53]
2022-11-21 21:09:06,760 INFO:     {file} checked, not a duplicate. [in function check_file     filename:file_handler.py:32]
2022-11-21 21:09:06,763 INFO:     Year successfully parsed form file name. [in function check_year     filename:name_parser.py:26]
2022-11-21 21:09:06,766 INFO:     Month successfully parsed from <FileStorage: 'expedia_report_monthly_march_2018.xlsx' ('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')>. [in function check_month     filename:name_parser.py:44]
